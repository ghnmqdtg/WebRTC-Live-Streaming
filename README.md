# WebRTC-Live-Streaming
## Introduction
Live streaming website with real-time chatting function.

## Structure
### Directories
I used `tree /f` command to print out directory paths and files and made it more concise. I filtered `material kit` out of the tree structure below because that's not the point for this repo. The basic structure is setup by running `express --view=ejs --css=sass `, if you're interested in it, the instruction is [here](https://hackmd.io/@tweizh0331/H1OEpCBDP).

```
WebRTC-Live-Streaming:.
│  .gitignore
│  app.js
│  package-lock.json  
│  package.json       
│  Procfile
│  README.md
│
├─bin
│      www
│
├─public
│  ├─demo
│  ├─images
│  ├─javascripts
│  │   main.js
│  │
│  └─stylesheets
│      style_new.css
|
├─routes
│      index.js
│      users.js
│
├─utils
│      messages.js
│      users.js
│
└─views
        chat.ejs
        index.ejs
```

### Files
* Back-end
    1. `./bin/www`:
    
        The entry of the application generated by the Express Application Generator. The first thing it does is to require('../app') which is `app.js` in the root, the “real” entry point. Besides, it runs all the backend server funcions, including `socket.io` realtime chat messages and basic `Express` function.
    
    2. `app.js`:
        
        Generated by the Express Application Generator.
        > I didn't modify it.

    3. `utils\messages.js`:
        
        Format the chat message with user name, text and time. Called by `./bin/www`.

    4. `utils\users.js`:

        Handles members info in the room, such as user who joining and leaving the room, current user and room members. Called by `./bin/www`.

    5. `routes\index.js`:
        
        The route file that loads the express module and the uses it to get an `express.Router` object. Then it specifies a route on that object and lastly exports the router from the module. I add some code to render the chatting room(the `chat.ejs`) and route the user to it.

        ```Javascript
        router.get('/chat', function(req, res, next) {
          res.render('chat');
        });
        ```

* Front-end
    1. `views\index.ejs`:
        
        The entry page. Users can choose a chatting room they want to join in the index page.

    2. `views\chat.ejs`
        
        Calls the `socket.io.js`, `peerjs` and `main.js`, users can chat and also see each other in the chat page.

    3. `public\stylesheets\style_new.css`:

        The temporary css file which renders the page. I will render the page with material kit in the next version.
    
    4. `public\javascripts\main.js`:

        The most important part of the frontend page, it deals chatting messages, media settings, and peer to peer communication.

## Sequence Diagram


## Usage
1. Install all the packages that you need

    ```
    $ npm install
    ```

2. Run the server

    ```
    $ npm run serverstart
    ```

## References
1. [Realtime Chat With Users & Rooms - Socket.io, Node & Express](https://www.youtube.com/watch?v=jD7FnbI76Hg)
2. [How To Create A Video Chat App With WebRTC](https://www.youtube.com/watch?v=DvlyzDZDEq4)
